(()=>{"use strict";var t=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"log";"error"===e?console&&"function"==typeof console.error&&console.error(t):console&&"function"==typeof console.info&&console.info(t)},e=function(e){return t(e,"error")},n=function(){return navigator.getGamepads&&"function"==typeof navigator.getGamepads||"function"==typeof navigator.webkitGetGamepads||!1},o="Invalid property.",i="Invalid value. It must be a number between 0.00 and 1.00.",a="Button does not exist.",s="Unknown event name.";const c=function(t){for(var n={id:t.index,buttons:t.buttons.length,axes:Math.floor(t.axes.length/2),axeValues:[],axeThreshold:[1],hapticActuator:null,vibrationMode:-1,vibration:!1,mapping:t.mapping,buttonActions:{},axesActions:{},pressed:{},set:function(t,n){if(["axeThreshold"].indexOf(t)>=0){if("axeThreshold"===t&&(!parseFloat(n)||n<0||n>1))return void e(i);this[t]=n}else e(o)},vibrate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.75,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;if(this.hapticActuator)switch(this.vibrationMode){case 0:return this.hapticActuator.pulse(t,e);case 1:return this.hapticActuator.playEffect("dual-rumble",{duration:e,strongMagnitude:t,weakMagnitude:t})}},triggerDirectionalAction:function(t,e,n,o,i){n&&o%2===i?(this.pressed["".concat(t).concat(e)]||(this.pressed["".concat(t).concat(e)]=!0,this.axesActions[e][t].before()),this.axesActions[e][t].action()):this.pressed["".concat(t).concat(e)]&&o%2===i&&(delete this.pressed["".concat(t).concat(e)],this.axesActions[e][t].after())},checkStatus:function(){var t=null,e=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads():[];if(e.length){if(!(t=e[this.id]))return;if(t.buttons)for(var n=0;n<this.buttons;n++)!0===t.buttons[n].pressed?(this.pressed["button".concat(n)]||(this.pressed["button".concat(n)]=!0,this.buttonActions[n].before()),this.buttonActions[n].action()):this.pressed["button".concat(n)]&&(delete this.pressed["button".concat(n)],this.buttonActions[n].after());if(t.axes)for(var o=t.axes.length%2,i=0;i<2*this.axes;i++){var a=Number(t.axes[i+o].toFixed(4)),s=Math.floor(i/2);this.axeValues[s][i%2]=a,this.triggerDirectionalAction("right",s,a>=this.axeThreshold[0],i,0),this.triggerDirectionalAction("left",s,a<=-this.axeThreshold[0],i,0),this.triggerDirectionalAction("down",s,a>=this.axeThreshold[0],i,1),this.triggerDirectionalAction("up",s,a<=-this.axeThreshold[0],i,1)}}},associateEvent:function(t,n,o){if(t.match(/^button\d+$/)){var i,c=parseInt((null===(i=t.match(/^button(\d+)$/))||void 0===i?void 0:i[1])||"0");c>=0&&c<this.buttons?this.buttonActions[c][o]=n:e(a)}else if("start"===t)this.buttonActions[9][o]=n;else if("select"===t)this.buttonActions[8][o]=n;else if("r1"===t)this.buttonActions[5][o]=n;else if("r2"===t)this.buttonActions[7][o]=n;else if("l1"===t)this.buttonActions[4][o]=n;else if("l2"===t)this.buttonActions[6][o]=n;else if("power"===t)this.buttons>=17?this.buttonActions[16][o]=n:e(a);else if(t.match(/^(up|down|left|right)(\d+)$/)){var r=t.match(/^(up|down|left|right)(\d+)$/);if(!r)return void e(s);var u=r[1],f=parseInt(r[2]);f>=0&&f<this.axes?this.axesActions[f][u][o]=n:e(a)}else if(t.match(/^(up|down|left|right)$/)){var h,d=null===(h=t.match(/^(up|down|left|right)$/))||void 0===h?void 0:h[1];if(!d)return void e(s);this.axesActions[0][d][o]=n}return this},on:function(t,e){return this.associateEvent(t,e,"action")},off:function(t){return this.associateEvent(t,(function(){}),"action")},after:function(t,e){return this.associateEvent(t,e,"after")},before:function(t,e){return this.associateEvent(t,e,"before")}},c=0;c<n.buttons;c++)n.buttonActions[c]={action:function(){},after:function(){},before:function(){}};for(var r=0;r<n.axes;r++)n.axesActions[r]={down:{action:function(){},after:function(){},before:function(){}},left:{action:function(){},after:function(){},before:function(){}},right:{action:function(){},after:function(){},before:function(){}},up:{action:function(){},after:function(){},before:function(){}}},n.axeValues[r]=[0,0];return t.hapticActuators?"function"==typeof t.hapticActuators.pulse?(n.hapticActuator=t.hapticActuators,n.vibrationMode=0,n.vibration=!0):t.hapticActuators[0]&&"function"==typeof t.hapticActuators[0].pulse&&(n.hapticActuator=t.hapticActuators[0],n.vibrationMode=0,n.vibration=!0):t.vibrationActuator&&"function"==typeof t.vibrationActuator.playEffect&&(n.hapticActuator=t.vibrationActuator,n.vibrationMode=1,n.vibration=!0),n};var r={gamepads:{},axeThreshold:[1],isReady:n(),onConnect:function(t){},onDisconnect:function(t){},onBeforeCycle:function(){},onAfterCycle:function(){},getGamepads:function(){return this.gamepads},getGamepad:function(t){return this.gamepads[t]?this.gamepads[t]:null},set:function(t,n){if(["axeThreshold"].indexOf(t)>=0){if("axeThreshold"===t&&(!parseFloat(n)||n<0||n>1))return void e(i);if(this[t]=n,"axeThreshold"===t)for(var a=this.getGamepads(),s=Object.keys(a),c=0;c<s.length;c++)a[s[c]].set("axeThreshold",this.axeThreshold)}else e(o)},checkStatus:function(){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame,e=Object.keys(r.gamepads);r.onBeforeCycle();for(var n=0;n<e.length;n++)r.gamepads[e[n]].checkStatus();r.onAfterCycle(),e.length>0&&t(r.checkStatus)},init:function(){var e=this;window.addEventListener("gamepadconnected",(function(n){var o=n.gamepad||n.detail.gamepad;if(t("Gamepad detected."),window.gamepads||(window.gamepads={}),o){if(!window.gamepads[o.index]){window.gamepads[o.index]=o;var i=c(o);i.set("axeThreshold",e.axeThreshold),e.gamepads[i.id]=i,e.onConnect(e.gamepads[i.id])}1===Object.keys(e.gamepads).length&&e.checkStatus()}})),window.addEventListener("gamepaddisconnected",(function(n){var o=n.gamepad||n.detail.gamepad;t("Gamepad disconnected."),o&&(delete window.gamepads[o.index],delete e.gamepads[o.index],e.onDisconnect(o.index))}))},on:function(t,n){switch(t){case"connect":this.onConnect=n;break;case"disconnect":this.onDisconnect=n;break;case"beforeCycle":case"beforecycle":this.onBeforeCycle=n;break;case"afterCycle":case"aftercycle":this.onAfterCycle=n;break;default:e(s)}return this},off:function(t){switch(t){case"connect":this.onConnect=function(t){};break;case"disconnect":this.onDisconnect=function(t){};break;case"beforeCycle":case"beforecycle":this.onBeforeCycle=function(){};break;case"afterCycle":case"aftercycle":this.onAfterCycle=function(){};break;default:e(s)}return this}};r.init();const u=r;n()?window.gameControl=u:e("Your web browser does not support the Gamepad API.")})();